<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI性格测试</title>
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .progress-bar {
            height: 6px;
            background-color: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #6366f1;
            transition: width 0.3s ease;
        }
        .option-card {
            transition: all 0.2s ease;
        }
        .option-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .option-card.selected {
            border-color: #6366f1;
            background-color: #eef2ff;
        }
        .result-card {
            background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
        }
        .mbti-letter {
            width: 3rem;
            height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border-radius: 0.5rem;
        }
        .mbti-letter.E {
            background-color: #ecfdf5;
            color: #10b981;
        }
        .mbti-letter.I {
            background-color: #f0f9ff;
            color: #3b82f6;
        }
        .mbti-letter.S {
            background-color: #fef2f2;
            color: #ef4444;
        }
        .mbti-letter.N {
            background-color: #f5f3ff;
            color: #8b5cf6;
        }
        .mbti-letter.T {
            background-color: #ecfdf5;
            color: #10b981;
        }
        .mbti-letter.F {
            background-color: #f0f9ff;
            color: #3b82f6;
        }
        .mbti-letter.J {
            background-color: #fef2f2;
            color: #ef4444;
        }
        .mbti-letter.P {
            background-color: #f5f3ff;
            color: #8b5cf6;
        }
        @media (max-width: 640px) {
            .test-container {
                padding: 1rem;
            }
            .option-card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="max-w-3xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
        <!-- 标题和简介 -->
        <div class="text-center mb-10">
            <h1 class="text-3xl font-bold text-gray-900 mb-3">MBTI性格测试</h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">通过28道精心设计的题目，了解你的性格类型，发现真实的自我</p>
        </div>

        <!-- 测试容器 -->
        <div id="testContainer" class="bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300">
            <!-- 进度条 -->
            <div class="px-6 pt-6">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                </div>
                <div class="flex justify-between mt-2 text-sm text-gray-500">
                    <span id="currentQuestion">0</span>/<span>28</span>
                </div>
            </div>

            <!-- 问题区域 -->
            <div class="p-6 sm:p-8">
                <!-- 问题展示 -->
                <div id="questionContainer" class="mb-8">
                    <h2 id="questionText" class="text-xl font-semibold text-gray-800 mb-6"></h2>
                    <div class="grid grid-cols-1 gap-4">
                        <div id="optionA" class="option-card p-4 border-2 border-gray-200 rounded-lg cursor-pointer">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center mr-3 font-semibold text-gray-700">A</div>
                                <span id="optionAText" class="text-gray-700"></span>
                            </div>
                        </div>
                        <div id="optionB" class="option-card p-4 border-2 border-gray-200 rounded-lg cursor-pointer">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center mr-3 font-semibold text-gray-700">B</div>
                                <span id="optionBText" class="text-gray-700"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 导航按钮 -->
                <div class="flex justify-between">
                    <button id="prevBtn" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <i class="fas fa-arrow-left mr-2"></i>上一题
                    </button>
                    <button id="nextBtn" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
                        下一题<i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- 结果展示区域 (初始隐藏) -->
        <div id="resultContainer" class="hidden mt-10">
            <div class="result-card rounded-xl shadow-md p-6 sm:p-8">
                <h2 class="text-2xl font-bold text-center mb-6">你的MBTI性格类型是: <span id="mbtiType" class="text-indigo-600"></span></h2>
                
                <!-- 结果收集表单 -->
                <form id="resultForm" action="ccg166.pythonanywhere.com/mbti/submit" method="POST" class="mb-8">
                    <input type="hidden" name="mbti_type" id="formMbtiType">
                    <input type="hidden" name="e_score" id="formEScore">
                    <input type="hidden" name="i_score" id="formIScore">
                    <input type="hidden" name="s_score" id="formSScore">
                    <input type="hidden" name="n_score" id="formNScore">
                    <input type="hidden" name="t_score" id="formTScore">
                    <input type="hidden" name="f_score" id="formFScore">
                    <input type="hidden" name="j_score" id="formJScore">
                    <input type="hidden" name="p_score" id="formPScore">
                    
                    <!-- 维度得分展示 -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold mb-4">各维度得分</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <div class="flex items-center mb-2">
                                    <div class="mbti-letter E mr-3">E</div>
                                    <div class="mbti-letter I">I</div>
                                    <div class="ml-auto font-medium"><span id="eScore">0</span> : <span id="iScore">0</span></div>
                                </div>
                                <div class="text-sm text-gray-600" id="eiDesc"></div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <div class="flex items-center mb-2">
                                    <div class="mbti-letter S mr-3">S</div>
                                    <div class="mbti-letter N">N</div>
                                    <div class="ml-auto font-medium"><span id="sScore">0</span> : <span id="nScore">0</span></div>
                                </div>
                                <div class="text-sm text-gray-600" id="snDesc"></div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <div class="flex items-center mb-2">
                                    <div class="mbti-letter T mr-3">T</div>
                                    <div class="mbti-letter F">F</div>
                                    <div class="ml-auto font-medium"><span id="tScore">0</span> : <span id="fScore">0</span></div>
                                </div>
                                <div class="text-sm text-gray-600" id="tfDesc"></div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <div class="flex items-center mb-2">
                                    <div class="mbti-letter J mr-3">J</div>
                                    <div class="mbti-letter P">P</div>
                                    <div class="ml-auto font-medium"><span id="jScore">0</span> : <span id="pScore">0</span></div>
                                </div>
                                <div class="text-sm text-gray-600" id="jpDesc"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 性格描述 -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold mb-4">性格描述</h3>
                        <div id="typeDescription" class="bg-white p-4 rounded-lg shadow-sm text-gray-700"></div>
                    </div>

                    <!-- 提交按钮 -->
                    <div class="text-center mb-6">
                        <button type="submit" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            <i class="fas fa-save mr-2"></i>保存测试结果
                        </button>
                    </div>
                </form>

                <!-- 重新测试按钮 -->
                <div class="text-center">
                    <button id="restartBtn" class="px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
                        <i class="fas fa-redo mr-2"></i>重新测试
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 测试题目数据
        const questions = [
            {
                text: "我倾向从何处得到动力和信心：",
                options: [
                    "别人。",
                    "我自己的想法。"
                ],
                dimension: "EI"
            },
            // ... 其余题目保持不变 ...
        ];

        // MBTI类型描述
        const typeDescriptions = {
            "ISTJ": "ISTJ型的人是安静、严肃的，通过全面性和可靠性获得成功...",
            // ... 其余类型描述保持不变 ...
        };

        // 初始化变量
        let currentQuestion = 0;
        const answers = Array(questions.length).fill(null);
        const scores = {
            E: 0, I: 0,
            S: 0, N: 0,
            T: 0, F: 0,
            J: 0, P: 0
        };

        // DOM元素
        const questionText = document.getElementById('questionText');
        const optionAText = document.getElementById('optionAText');
        const optionBText = document.getElementById('optionBText');
        const optionA = document.getElementById('optionA');
        const optionB = document.getElementById('optionB');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const progressFill = document.getElementById('progressFill');
        const currentQuestionSpan = document.getElementById('currentQuestion');
        const testContainer = document.getElementById('testContainer');
        const resultContainer = document.getElementById('resultContainer');
        const mbtiType = document.getElementById('mbtiType');
        const eScore = document.getElementById('eScore');
        const iScore = document.getElementById('iScore');
        const sScore = document.getElementById('sScore');
        const nScore = document.getElementById('nScore');
        const tScore = document.getElementById('tScore');
        const fScore = document.getElementById('fScore');
        const jScore = document.getElementById('jScore');
        const pScore = document.getElementById('pScore');
        const eiDesc = document.getElementById('eiDesc');
        const snDesc = document.getElementById('snDesc');
        const tfDesc = document.getElementById('tfDesc');
        const jpDesc = document.getElementById('jpDesc');
        const typeDescription = document.getElementById('typeDescription');
        const restartBtn = document.getElementById('restartBtn');
        const resultForm = document.getElementById('resultForm');
        const formMbtiType = document.getElementById('formMbtiType');
        const formEScore = document.getElementById('formEScore');
        const formIScore = document.getElementById('formIScore');
        const formSScore = document.getElementById('formSScore');
        const formNScore = document.getElementById('formNScore');
        const formTScore = document.getElementById('formTScore');
        const formFScore = document.getElementById('formFScore');
        const formJScore = document.getElementById('formJScore');
        const formPScore = document.getElementById('formPScore');

        // 加载问题
        function loadQuestion(index) {
            // ... 保持不变 ...
        }

        // 选择选项
        function selectOption(option) {
            // ... 保持不变 ...
        }

        // 计算MBTI类型
        function calculateMBTI() {
            // ... 保持不变 ...
        }

        // 显示结果
        function showResults() {
            const type = calculateMBTI();
            
            // 更新UI
            mbtiType.textContent = type;
            eScore.textContent = scores.E;
            iScore.textContent = scores.I;
            sScore.textContent = scores.S;
            nScore.textContent = scores.N;
            tScore.textContent = scores.T;
            fScore.textContent = scores.F;
            jScore.textContent = scores.J;
            pScore.textContent = scores.P;
            
            // 更新描述
            eiDesc.textContent = getPreferenceDescription(scores.E, scores.I, "外向", "内向");
            snDesc.textContent = getPreferenceDescription(scores.S, scores.N, "感觉", "直觉");
            tfDesc.textContent = getPreferenceDescription(scores.T, scores.F, "思考", "情感");
            jpDesc.textContent = getPreferenceDescription(scores.J, scores.P, "判断", "知觉");
            
            typeDescription.textContent = typeDescriptions[type] || "暂无该类型的详细描述。";
            
            // 填充表单数据
            formMbtiType.value = type;
            formEScore.value = scores.E;
            formIScore.value = scores.I;
            formSScore.value = scores.S;
            formNScore.value = scores.N;
            formTScore.value = scores.T;
            formFScore.value = scores.F;
            formJScore.value = scores.J;
            formPScore.value = scores.P;
            
            // 显示结果容器
            testContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');
        }

        // 获取偏好强度描述
        function getPreferenceDescription(score1, score2, type1, type2) {
            // ... 保持不变 ...
        }

        // 表单提交处理
        resultForm.addEventListener('submit', function(e) {
            e.preventDefault();
            // 这里可以添加AJAX提交逻辑（如果需要异步提交）
            // 示例：
            /*
            fetch(this.action, {
                method: 'POST',
                body: new FormData(this),
            })
            .then(response => response.json())
            .then(data => {
                alert('结果保存成功！');
            })
            .catch(error => {
                alert('保存失败，请重试。');
            });
            */
            
            // 如果不需要AJAX，直接提交表单
            this.submit();
        });

        // 事件监听
        optionA.addEventListener('click', () => selectOption(optionA));
        optionB.addEventListener('click', () => selectOption(optionB));
        
        prevBtn.addEventListener('click', () => {
            // ... 保持不变 ...
        });
        
        nextBtn.addEventListener('click', () => {
            // ... 保持不变 ...
        });
        
        restartBtn.addEventListener('click', () => {
            // ... 保持不变 ...
        });

        // 初始化
        loadQuestion(0);
    </script>
</body>
</html>
